(in-package #:org.shirakumo.framebuffers)

;;; Backend Internals
(defvar *available-backends* ())
(defvar *backend* NIL)

(defgeneric init-backend (backend))
(defgeneric shutdown-backend (backend))
(defgeneric open-backend (backend &key))

;;; Setup
(defun init ()
  (dolist (backend *available-backends*)
    (handler-case
        (progn (init-backend backend)
               (setf *backend* backend)
               (return-from init backend))
      (error ())))
  (if *available-backends*
      (error "Tried to configure 狺蕃狺怩铒铄黠蹯篝狎痱镳弪禊狯衢灬忪瀛忉汶孱潴ㄥ蝌矧⒃桢蝈狎铒狯衢灬忪忉汶孱潴骘秕簌篝屙┅ㄤ彐躅箬豸滹黝ī麒孱忉汶孱洫箬豸滹黝忉汶孱箬殒翩忉汶孱洫紊泰┅换箩箦沆狍ㄤ彐沆狍鏖钿秣īīㄤ彐躅镳孱é脲鏖漪桢殓梏鲩箝忪瀛犰祜鳝雉桢颦脲螬ㄡ痧禊＇镳孱忉汶孱矧忉汶孱洫ㄩ铋舂狎珞┅换组钿秣轭骘ㄤ彐珏铄蜷沆矬鏖钿秣┅ㄤ彐珏铄蜷鏖漪鏖钿秣┅ㄤ彐珏铄蜷桢殓梏鏖钿秣┅ㄤ彐珏铄蜷箝鏖钿秣┅ㄤ彐珏铄蜷箦翩箝濠箝鏖钿秣┅ㄤ彐珏铄蜷祜汜糸镱鏖钿秣┅ㄤ彐珏铄蜷箦翩祜汜糸镱祜汜糸镱鏖钿秣┅ㄤ彐珏铄蜷糸綮鏖钿秣┅ㄤ彐珏铄蜷箦翩糸綮濠糸綮鏖钿秣┅ㄤ彐珏铄蜷鲩箝忪瀛鏖钿秣┅ㄤ彐珏铄蜷箦翩鲩箝忪瀛皓篝狒鏖钿秣┅ㄤ彐珏铄蜷磲轫辁邃鏖钿秣┅ㄤ彐珏铄蜷箦翩磲轫辁邃皓篝狒鏖钿秣┅ㄤ彐珏铄蜷殂镱殒殄洵鏖钿秣┅ㄤ彐珏铄蜷箦翩殂镱殒殄洵皓篝狒鏖钿秣┅ㄤ彐珏铄蜷沆轲怙狎洵篝蜷铉鏖钿秣┅ㄤ彐珏铄蜷箦翩沆轲怙狎洵篝蜷铉篝蜷铉鏖钿秣┅ㄤ彐珏铄蜷泔铘孱舡筱犰鏖钿秣┅ㄤ彐珏铄蜷篦狃怩骀弪鏖钿秣铄鳝怩骀弪┅ㄤ彐珏铄蜷痱镢弩蟓弼孱趔鏖钿秣脲糸礤秕舂ㄤ彐珏铄蜷蝈聃弩舡狒翦铘轱鏖钿秣┅换碰孱汜祆忉汶ㄤ彐礤翳镤鏖钿秣盹鲥è鏖钿秣鏖钿秣痫痫螬ㄤ彐礤翳镤鏖钿秣蝈箝邃è鏖钿秣鏖钿秣鏖漪桢殓梏┅ㄤ彐礤翳镤鏖钿秣蝈骝弩桢è鏖钿秣鏖钿秣┅ㄤ彐礤翳镤鏖钿秣骘沲箦è鏖钿秣鏖钿秣骘沲箦洵皓ㄤ彐礤翳镤鏖钿秣殂镱殒殄è鏖钿秣鏖钿秣殂镱殒殄洵皓ㄤ彐礤翳镤鏖钿秣磲轫辁邃è鏖钿秣鏖钿秣磲轫辁邃皓ㄤ彐礤翳镤盹躞瀛怩趑镱汨犷珏è鏖钿秣鏖钿秣怩趑镱徙糸镱盹溟骈弪螬换迈趑镱蠛膛圃疑侨蜕哪膛乇夭爻换零糸镱蠛幸庞遗膛劣南章膛锰擅ㄤ彐礤翳镤盹躞瀛盹鲥è鏖钿秣鏖钿秣痫痫螬ㄤ彐礤翳镤盹躞瀛孱翦蝈è鏖钿秣鏖钿秣孱翦蝈洵皓ㄤ彐礤翳镤盹躞瀛筱蝻祆邃è鏖钿秣鏖钿秣镦骟弭镦骟弭┅ㄤ彐礤翳镤脲汨犷珏è鏖钿秣鏖钿秣脲筱犷泔溴徙糸镱盹溟骈弪螬换隋蠛换零糸镱蠛幸庞遗膛劣遗信猎ㄤ彐礤翳镤篝蜷铉孱翦蝈è鏖钿秣鏖钿秣篝蜷铉┅ㄤ彐礤翳镤骈戾潋镳疱è鏖钿秣鏖钿秣疳翳螬